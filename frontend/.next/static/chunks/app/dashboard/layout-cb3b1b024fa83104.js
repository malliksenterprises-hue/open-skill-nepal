(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{2601:function(e,t,o){"use strict";var r,n;e.exports=(null==(r=o.g.process)?void 0:r.env)&&"object"==typeof(null==(n=o.g.process)?void 0:n.env)?o.g.process:o(8960)},2374:function(e,t,o){Promise.resolve().then(o.bind(o,6975))},6975:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return DashboardLayout}});var r=o(7437),n=o(8508),s=o(4033),i=o(2265);function DashboardLayout(e){var t;let{children:o}=e,{user:l,logout:a,loading:u}=(0,n.useAuth)(),c=(0,s.useRouter)(),[d,h]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{u||l||c.push("/login")},[l,u,c]),u)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})});if(!l)return null;let handleLogout=async()=>{await a(),c.push("/login")};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("nav",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:()=>h(!d),className:"md:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,r.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Open Skill Nepal"}),(0,r.jsx)("span",{className:"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:{super_admin:"Super Admin",admin:"Admin",school_admin:"School Admin",teacher:"Teacher",student:"Student"}[t=l.role]||t})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:["Welcome, ",(0,r.jsx)("span",{className:"font-semibold",children:l.name})]}),(0,r.jsx)("button",{onClick:handleLogout,className:"bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-md text-sm font-medium text-gray-700 transition-colors",children:"Logout"})]})]})})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:o}),d&&(0,r.jsxs)("div",{className:"fixed inset-0 flex z-40 md:hidden",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>h(!1)}),(0,r.jsx)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:(0,r.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,r.jsx)("div",{className:"flex-shrink-0 flex items-center px-4",children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Dashboard Menu"})}),(0,r.jsx)("nav",{className:"mt-5 px-2 space-y-1"})]})})]})]})}},8508:function(e,t,o){"use strict";o.r(t),o.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=o(7437),n=o(2265),s=o(2601);let i=s.env.NEXT_PUBLIC_API_URL?s.env.NEXT_PUBLIC_API_URL:"https://open-skill-nepal-669869115660.asia-south1.run.app/api";async function apiRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="".concat(i).concat(e);console.group("\uD83C\uDF10 API Request: ".concat(e)),console.log("Full URL:",o),console.log("Method:",t.method||"GET"),console.log("Payload:",t.body);let r={method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers},credentials:"include",signal:AbortSignal.timeout(3e4)};t.body&&"GET"!==r.method&&(r.body=JSON.stringify(t.body));try{let e=await fetch(o,r);console.log("Response Status:",e.status),console.log("Response Headers:",Object.fromEntries(e.headers.entries()));let t=await e.json();if(console.log("Response Data:",t),!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(t.message||"Request failed"));return console.groupEnd(),t}catch(e){if(console.groupEnd(),"AbortError"===e.name)throw Error("Request timeout: Server took too long to respond");if("TypeError"===e.name)throw Error("Network error: Cannot connect to server");throw e}}let l={login:async(e,t)=>{if(!e||!t)throw Error("Email and password are required");return apiRequest("/auth/login",{method:"POST",body:{email:e,password:t}})},googleLogin:e=>{if(!(null==e?void 0:e.email)||!(null==e?void 0:e.googleId))throw Error("Google authentication data is incomplete");return apiRequest("/auth/google-login",{method:"POST",body:e})},getMe:e=>{if(!e)throw Error("Authentication token is required");return apiRequest("/auth/me",{headers:{Authorization:"Bearer ".concat(e)}})},logout:e=>apiRequest("/auth/logout",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})},a=(0,n.createContext)();function AuthProvider(e){let{children:t}=e,[o,s]=(0,n.useState)(null),[i,u]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{checkAuth()},[]);let checkAuth=async()=>{try{let e=localStorage.getItem("openSkillToken");if(e){d(e);let t=await l.getMe(e);s(t)}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("openSkillToken"),d(null),s(null)}finally{u(!1)}},login=async(e,t)=>{try{console.log("\uD83D\uDD04 AuthContext: Attempting login...");let o=await l.login(e,t);console.log("✅ AuthContext: Login response:",o);let{token:r,user:n}=o;return localStorage.setItem("openSkillToken",r),d(r),s(n),{success:!0,user:n}}catch(e){var o;return console.error("❌ AuthContext: Login error:",e),{success:!1,message:e.message||(null===(o=e.data)||void 0===o?void 0:o.message)||"Login failed"}}},googleLogin=async e=>{try{console.log("\uD83D\uDD04 AuthContext: Attempting Google login...");let t=await l.googleLogin(e);console.log("✅ AuthContext: Google login response:",t);let{token:o,user:r}=t;return localStorage.setItem("openSkillToken",o),d(o),s(r),{success:!0,user:r}}catch(e){var t;return console.error("❌ AuthContext: Google login error:",e),{success:!1,message:e.message||(null===(t=e.data)||void 0===t?void 0:t.message)||"Google login failed"}}},logout=async()=>{try{c&&await l.logout(c)}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("openSkillToken"),d(null),s(null)}};return(0,r.jsx)(a.Provider,{value:{user:o,token:c,loading:i,login,googleLogin,logout,isAuthenticated:!!o},children:t})}function useAuth(){let e=(0,n.useContext)(a);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8960:function(e){!function(){var t={229:function(e){var t,o,r,n=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(o){try{return t.call(null,e,0)}catch(o){return t.call(this,e,0)}}}function runClearTimeout(e){if(o===clearTimeout)return clearTimeout(e);if((o===defaultClearTimeout||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{return o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{o="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){o=defaultClearTimeout}}();var s=[],i=!1,l=-1;function cleanUpNextTick(){i&&r&&(i=!1,r.length?s=r.concat(s):l=-1,s.length&&drainQueue())}function drainQueue(){if(!i){var e=runTimeout(cleanUpNextTick);i=!0;for(var t=s.length;t;){for(r=s,s=[];++l<t;)r&&r[l].run();l=-1,t=s.length}r=null,i=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];s.push(new Item(e,t)),1!==s.length||i||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=noop,n.addListener=noop,n.once=noop,n.off=noop,n.removeListener=noop,n.removeAllListeners=noop,n.emit=noop,n.prependListener=noop,n.prependOnceListener=noop,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},o={};function __nccwpck_require__(e){var r=o[e];if(void 0!==r)return r.exports;var n=o[e]={exports:{}},s=!0;try{t[e](n,n.exports,__nccwpck_require__),s=!1}finally{s&&delete o[e]}return n.exports}__nccwpck_require__.ab="//";var r=__nccwpck_require__(229);e.exports=r}()},622:function(e,t,o){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=o(2265),n=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,o){var r,a={},u=null,c=null;for(r in void 0!==o&&(u=""+o),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:n,type:e,key:u,ref:c,props:a,_owner:i.current}}t.jsx=q,t.jsxs=q},7437:function(e,t,o){"use strict";e.exports=o(622)},4033:function(e,t,o){e.exports=o(94)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=2374)}),_N_E=e.O()}]);